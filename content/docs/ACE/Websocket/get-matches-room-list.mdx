---
title: "è·å–è‡ªå®šä¹‰ç«æŠ€å¤§å…æˆ¿é—´åˆ—è¡¨"
description: "GetMatchesRoomList - è·å–å¤§å…æˆ¿é—´åˆ—è¡¨"
---

# è·å–æˆ¿é—´æ¥å£

## æ¥å£ä¿¡æ¯

- **æ¥å£åç§°**: `GetMatchesRoomList`
- **æè¿°**: è·å–è‡ªå®šä¹‰ç«æŠ€å¤§å…æˆ¿é—´åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œå®æ—¶æ›´æ–°é€šçŸ¥
- **è°ƒç”¨æ–¹å¼**: SignalR Hubæ–¹æ³•è°ƒç”¨

## å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| page | number | æ˜¯ | 1 | é¡µç ï¼Œä»1å¼€å§‹ |

### å‚æ•°ç¤ºä¾‹

```json
{
    "page": 1
}
```

## è°ƒç”¨ç¤ºä¾‹

### å‰ç«¯è°ƒç”¨ï¼ˆJavaScriptï¼‰

```javascript
// å¼•å…¥å…¨å±€Websocketä¸Šä¸‹æ–‡ã€ç›‘å¬å™¨
import { useUtilsService, useUtilsServiceContext } from "@/lib/hub";

export default function MatchesPage() {
    // å£°æ˜æ–¹æ³•ï¼šè¯·æ±‚ï¼ŒWebsocketè¿æ¥çŠ¶æ€å€¼ï¼šè¿æ¥çŠ¶æ€ã€æ˜¯å¦è¿æ¥
    const { invoke, connectionState, isConnected } = useUtilsServiceContext(); 
    const [roomList, setRoomList] = useState<MatchesRoom[]>([]);
    const [totalCount, setTotalCount] = useState(0);
    const [currentPage, setCurrentPage] = useState(1);
    const [totalPages, setTotalPages] = useState(1);
    const [pageSize, setPageSize] = useState(20);

    // è·å–æˆ¿é—´åˆ—è¡¨å‡½æ•°
    const getRoomList = async (page = 1) => {
        try {
            // è°ƒç”¨è·å–æˆ¿é—´åˆ—è¡¨æ¥å£
            invoke("GetMatchesRoomList", page)
                .then(result => {
                    console.log("è·å–æˆ¿é—´åˆ—è¡¨æˆåŠŸ:", result);
                    setRoomList(result.rooms);
                    setTotalCount(result.totalCount);
                    setCurrentPage(result.currentPage);
                    setTotalPages(result.totalPages);
                    setPageSize(result.pageSize);
                })
                .catch(err => {
                    console.error("è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥:", err);
                });
        } catch (error) {
            console.error("è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥:", error);
        }
    };

    // ç›‘å¬æˆ¿é—´åˆ—è¡¨æ›´æ–°äº‹ä»¶
    useUtilsService("RoomListUpdated", (data: { 
        rooms: MatchesRoom[], 
        totalCount: number,
        currentPage: number,
        totalPages: number,
        pageSize: number
    }) => {
        console.log("æ”¶åˆ°æˆ¿é—´åˆ—è¡¨æ›´æ–°:", data);
        setRoomList(data.rooms);
        setTotalCount(data.totalCount);
        setCurrentPage(data.currentPage);
        setTotalPages(data.totalPages);
        setPageSize(data.pageSize);
    });

    // ç›‘å¬å•ä¸ªæˆ¿é—´æ›´æ–°äº‹ä»¶
    useUtilsService("RoomUpdated", (roomData: MatchesRoom) => {
        console.log("æ”¶åˆ°æˆ¿é—´æ›´æ–°:", roomData);
        setRoomList(prevList => {
            const updatedList = prevList.map(room => 
                room.ID === roomData.ID ? roomData : room
            );
            return updatedList;
        });
    });

    // ç›‘å¬æˆ¿é—´åˆ é™¤äº‹ä»¶
    useUtilsService("RoomDeleted", (roomID: string) => {
        console.log("æˆ¿é—´è¢«åˆ é™¤:", roomID);
        setRoomList(prevList => 
            prevList.filter(room => room.ID !== roomID)
        );
    });

    // ç›‘å¬æˆ¿é—´åˆ›å»ºäº‹ä»¶
    useUtilsService("RoomCreated", (roomData: MatchesRoom) => {
        console.log("æ–°æˆ¿é—´åˆ›å»º:", roomData);
        setRoomList(prevList => {
            // å¦‚æœåˆ—è¡¨å·²æ»¡ï¼Œç§»é™¤æœ€åä¸€ä¸ªæˆ¿é—´
            const newList = prevList.length >= 20 
                ? prevList.slice(0, 19) 
                : prevList;
            return [roomData, ...newList];
        });
    });

    // ç»„ä»¶æŒ‚è½½æ—¶è·å–æˆ¿é—´åˆ—è¡¨
    useEffect(() => {
        if (isConnected) {
            getRoomList(1); // è·å–ç¬¬ä¸€é¡µ
        }
    }, [isConnected]);

    // åˆ†é¡µå¤„ç†å‡½æ•°
    const handlePageChange = (newPage: number) => {
        if (newPage >= 1 && newPage <= totalPages) {
            setCurrentPage(newPage);
            getRoomList(newPage);
        }
    };

    return (
        <div>
            <h1>è‡ªå®šä¹‰ç«æŠ€å¤§å…</h1>
            <p>æ€»æˆ¿é—´æ•°: {totalCount}</p>
            <p>å½“å‰é¡µ: {currentPage} / {totalPages}</p>
            
            <div className="room-list">
                {roomList.map(room => (
                    <div key={room.ID} className="room-item">
                        <h3>{room.Name}</h3>
                        <p>æˆ¿ä¸»: {room.OwnerID}</p>
                        <p>çŠ¶æ€: {room.Status}</p>
                        <p>ç©å®¶æ•°: {room.Members.length}/{room.RoomSetting.MaxPlayer}</p>
                        <p>åœ°å›¾: {room.GameSettings.Map}</p>
                        {room.RoomSetting.Password && (
                            <p>ğŸ”’ éœ€è¦å¯†ç </p>
                        )}
                    </div>
                ))}
            </div>
            
            {/* åˆ†é¡µæ§ä»¶ */}
            <div className="pagination">
                <button 
                    onClick={() => handlePageChange(currentPage - 1)}
                    disabled={currentPage <= 1}
                >
                    ä¸Šä¸€é¡µ
                </button>
                <span>ç¬¬ {currentPage} é¡µï¼Œå…± {totalPages} é¡µ</span>
                <button 
                    onClick={() => handlePageChange(currentPage + 1)}
                    disabled={currentPage >= totalPages}
                >
                    ä¸‹ä¸€é¡µ
                </button>
            </div>
        </div>
    );
}
```

### åç«¯å®ç°ï¼ˆC#ï¼‰

```csharp
public class LeisureCenterService : Hub
{
    private static IHubContext<LeisureCenterService> _hubContext;
    public static List<CustomRoom> CustomRoomPool = new List<CustomRoom>();
    public static List<CustomRoom> CustomRoomInvitePool = new List<CustomRoom>();
    public static List<IMessage> MessageList = new List<IMessage>();
    
    // æˆ¿é—´æ›´æ–°è®¢é˜…è€…ç®¡ç†
    private static Dictionary<string, List<string>> _roomUpdateSubscribers = new Dictionary<string, List<string>>();
    private static Timer _roomUpdateTimer;

    public LeisureCenterService(IHubContext<LeisureCenterService> hubContext)
    {
        _hubContext = hubContext;
        
        // åˆå§‹åŒ–å®šæ—¶å™¨ï¼Œæ¯åˆ†é’Ÿæ£€æŸ¥æˆ¿é—´æ›´æ–°
        if (_roomUpdateTimer == null)
        {
            _roomUpdateTimer = new Timer(CheckRoomUpdates, null, TimeSpan.Zero, TimeSpan.FromMinutes(1));
        }
    }

    /// <summary>
    /// è·å–æˆ¿é—´åˆ—è¡¨ï¼ˆå¸¦åˆ†é¡µå’Œå®æ—¶æ›´æ–°ï¼‰
    /// </summary>
    /// <param name="page">é¡µç ï¼Œä»1å¼€å§‹</param>
    /// <returns>æˆ¿é—´åˆ—è¡¨å’Œæ€»æ•°</returns>
    public async Task<object> GetMatchesRoomList(int page)
    {
        try
        {
            // éªŒè¯é¡µç å‚æ•°
            if (page < 1)
            {
                throw new HubException("é¡µç å¿…é¡»å¤§äºç­‰äº1");
            }

            // è®¡ç®—åˆ†é¡µå‚æ•°
            int pageSize = 20;
            int skip = (page - 1) * pageSize;
            
            // è·å–å…¬å¼€çš„æˆ¿é—´åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰
            var publicRooms = CustomRoomPool
                .Where(room => room.BaseInfo.TeamOpenStatus == true) // åªè·å–å…¬å¼€æˆ¿é—´
                .OrderByDescending(room => room.RoomID) // æŒ‰åˆ›å»ºæ—¶é—´å€’åº
                .Skip(skip)
                .Take(pageSize)
                .ToList();

            // è½¬æ¢ä¸ºå‰ç«¯éœ€è¦çš„æ ¼å¼
            var roomList = publicRooms.Select(room => ConvertToMatchesRoom(room)).ToList();

            // å°†è¿æ¥æ·»åŠ åˆ°æˆ¿é—´æ›´æ–°è®¢é˜…è€…åˆ—è¡¨
            await AddRoomUpdateSubscriber(Context.ConnectionId);

            // å°†è¿æ¥åŠ å…¥å¤§å…ç»„
            await Groups.AddToGroupAsync(Context.ConnectionId, "CustomRoomHall");

            // è¿”å›æˆ¿é—´åˆ—è¡¨å’Œåˆ†é¡µä¿¡æ¯
            return new
            {
                rooms = roomList,
                totalCount = CustomRoomPool.Count(r => r.BaseInfo.TeamOpenStatus == true),
                currentPage = page,
                pageSize = pageSize,
                totalPages = (int)Math.Ceiling((double)CustomRoomPool.Count(r => r.BaseInfo.TeamOpenStatus == true) / pageSize),
                timestamp = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
            };
        }
        catch (Exception ex)
        {
            _logger.LogError($"è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥: {ex.Message}");
            throw new HubException($"è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥: {ex.Message}");
        }
    }

    /// <summary>
    /// å°†CustomRoomè½¬æ¢ä¸ºMatchesRoomæ ¼å¼
    /// </summary>
    private MatchesRoom ConvertToMatchesRoom(CustomRoom customRoom)
    {
        return new MatchesRoom
        {
            ID = customRoom.RoomID,
            Name = customRoom.BaseInfo.RoomName,
            Type = customRoom.BaseInfo.TeamOpenStatus == false, // ç§äººæˆ¿é—´
            OwnerID = customRoom.Owner.UID,
            Members = customRoom.TeamMembers.Select(p => new MatchesPlayer
            {
                ConnectID = p.ConnectID,
                UID = p.UID,
                Name = p.PInfo.Username,
                Avatar = p.PInfo.AvatarUrl,
                SteamID = p.SteamId
            }).ToList(),
            Visitors = new List<MatchesPlayer>(), // è§‚æˆ˜è€…åˆ—è¡¨
            ReadyPlayers = new List<string>(), // å‡†å¤‡ç©å®¶åˆ—è¡¨
            GameSettings = new MatchesGameSettings
            {
                Mode = GetGameMode(customRoom.GameInfo.GameMode),
                GameMode = "Competitive", // é»˜è®¤ç«æŠ€æ¨¡å¼
                Map = customRoom.GameInfo.GameMap
            },
            RoomSetting = new MatchesRoomSetting
            {
                Password = customRoom.BaseInfo.Password,
                MaxPlayer = customRoom.BaseInfo.MaxPlayerSize,
                Player_Choose = true, // é»˜è®¤å…è®¸ç©å®¶é€‰æ‹©
                GameStart = false // é»˜è®¤æˆ¿ä¸»å¼€å§‹
            },
            ServerSetting = new MatchesServerSetting
            {
                Region = customRoom.Server.ServerRegion,
                ID = customRoom.Server.ServerID,
                Status = GetServerStatus(customRoom.Server.Status),
                IP_Address = customRoom.Server.ServerIP,
                Port = customRoom.Server.Port,
                CreateTime = customRoom.Server.CreateTime
            },
            Status = customRoom.GameInfo.GameStatus == true ? "gameing" : "wait",
            CreateTime = customRoom.Server.CreateTime
        };
    }

    /// <summary>
    /// æ·»åŠ æˆ¿é—´æ›´æ–°è®¢é˜…è€…
    /// </summary>
    private async Task AddRoomUpdateSubscriber(string connectionId)
    {
        lock (_roomUpdateSubscribers)
        {
            if (!_roomUpdateSubscribers.ContainsKey("hall"))
            {
                _roomUpdateSubscribers["hall"] = new List<string>();
            }
            
            if (!_roomUpdateSubscribers["hall"].Contains(connectionId))
            {
                _roomUpdateSubscribers["hall"].Add(connectionId);
            }
        }
    }

    /// <summary>
    /// æ£€æŸ¥æˆ¿é—´æ›´æ–°å¹¶é€šçŸ¥è®¢é˜…è€…
    /// </summary>
    private async void CheckRoomUpdates(object state)
    {
        try
        {
            var publicRooms = CustomRoomPool
                .Where(room => room.BaseInfo.TeamOpenStatus == true)
                .OrderByDescending(room => room.RoomID)
                .Take(20)
                .ToList();

            var roomList = publicRooms.Select(room => ConvertToMatchesRoom(room)).ToList();
            var totalCount = CustomRoomPool.Count(r => r.BaseInfo.TeamOpenStatus == true);

            // å‘æ‰€æœ‰è®¢é˜…è€…å¹¿æ’­æˆ¿é—´åˆ—è¡¨æ›´æ–°
            await _hubContext.Clients.Group("CustomRoomHall").SendAsync("RoomListUpdated", new
            {
                rooms = roomList,
                totalCount = totalCount,
                currentPage = 1, // å®æ—¶æ›´æ–°åªæ›´æ–°ç¬¬ä¸€é¡µ
                pageSize = 20,
                totalPages = (int)Math.Ceiling((double)totalCount / 20),
                timestamp = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
            });
        }
        catch (Exception ex)
        {
            _logger.LogError($"æ£€æŸ¥æˆ¿é—´æ›´æ–°å¤±è´¥: {ex.Message}");
        }
    }

    /// <summary>
    /// å¹¿æ’­å•ä¸ªæˆ¿é—´æ›´æ–°
    /// </summary>
    public static async Task BroadcastRoomUpdate(CustomRoom room)
    {
        try
        {
            var matchesRoom = ConvertToMatchesRoom(room);
            
            await _hubContext.Clients.Group("CustomRoomHall").SendAsync("RoomUpdated", matchesRoom);
        }
        catch (Exception ex)
        {
            _logger.LogError($"å¹¿æ’­æˆ¿é—´æ›´æ–°å¤±è´¥: {ex.Message}");
        }
    }

    /// <summary>
    /// å¹¿æ’­æˆ¿é—´åˆ›å»ºäº‹ä»¶
    /// </summary>
    public static async Task BroadcastRoomCreated(CustomRoom room)
    {
        try
        {
            var matchesRoom = ConvertToMatchesRoom(room);
            
            await _hubContext.Clients.Group("CustomRoomHall").SendAsync("RoomCreated", matchesRoom);
        }
        catch (Exception ex)
        {
            _logger.LogError($"å¹¿æ’­æˆ¿é—´åˆ›å»ºå¤±è´¥: {ex.Message}");
        }
    }

    /// <summary>
    /// å¹¿æ’­æˆ¿é—´åˆ é™¤äº‹ä»¶
    /// </summary>
    public static async Task BroadcastRoomDeleted(string roomID)
    {
        try
        {
            await _hubContext.Clients.Group("CustomRoomHall").SendAsync("RoomDeleted", roomID);
        }
        catch (Exception ex)
        {
            _logger.LogError($"å¹¿æ’­æˆ¿é—´åˆ é™¤å¤±è´¥: {ex.Message}");
        }
    }

    /// <summary>
    /// è·å–æ¸¸æˆæ¨¡å¼
    /// </summary>
    private string GetGameMode(string gameMode)
    {
        return gameMode switch
        {
            "ç«æŠ€æ¨¡å¼" => "fiveVSfive",
            "åŒäººç«æŠ€" => "twoVStwo",
            "å•äººç«æŠ€" => "oneVSone",
            "çˆ†å¤´ç«æŠ€" => "oneVSone_headshot",
            _ => "fiveVSfive"
        };
    }

    /// <summary>
    /// è·å–æœåŠ¡å™¨çŠ¶æ€
    /// </summary>
    private string GetServerStatus(string status)
    {
        return status switch
        {
            "NOTLINE" => "wait_create",
            "CREATING" => "creating",
            "ONLINE" => "running",
            "WAITING" => "waiting",
            "CLOSED" => "closed",
            _ => "wait_create"
        };
    }

    /// <summary>
    /// è¿æ¥æ–­å¼€æ—¶çš„æ¸…ç†
    /// </summary>
    public override async Task OnDisconnectedAsync(Exception exception)
    {
        try
        {
            // ä»æˆ¿é—´æ›´æ–°è®¢é˜…è€…åˆ—è¡¨ä¸­ç§»é™¤
            var connectionId = Context.ConnectionId;
            lock (_roomUpdateSubscribers)
            {
                if (_roomUpdateSubscribers.ContainsKey("hall"))
                {
                    _roomUpdateSubscribers["hall"].Remove(connectionId);
                    if (_roomUpdateSubscribers["hall"].Count == 0)
                    {
                        _roomUpdateSubscribers.Remove("hall");
                    }
                }
            }

            await base.OnDisconnectedAsync(exception);
        }
        catch (Exception ex)
        {
            _logger.LogError($"è¿æ¥æ–­å¼€å¤„ç†å¤±è´¥: {ex.Message}");
        }
    }
}
```

## è¿”å›äº‹ä»¶

### RoomListUpdated äº‹ä»¶

å½“æˆ¿é—´åˆ—è¡¨æœ‰æ›´æ–°æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå‘æ‰€æœ‰è®¢é˜…è€…å¹¿æ’­ `RoomListUpdated` äº‹ä»¶ã€‚

#### äº‹ä»¶åç§°
`RoomListUpdated`

#### äº‹ä»¶æ•°æ®
```json
{
    "rooms": [
        {
            "ID": "072504001",
            "Name": "æµ‹è¯•æˆ¿é—´1",
            "Type": false,
            "OwnerID": "08233-87956-48746-16119-67337",
            "Members": [
                {
                    "ConnectID": "connection123",
                    "UID": "08233-87956-48746-16119-67337",
                    "Name": "æˆ¿ä¸»",
                    "Avatar": "avatar_url",
                    "SteamID": "steam_id"
                }
            ],
            "Visitors": [],
            "ReadyPlayers": [],
            "GameSettings": {
                "Mode": "fiveVSfive",
                "GameMode": "Competitive",
                "Map": "de_dust2"
            },
            "RoomSetting": {
                "Password": "",
                "MaxPlayer": 10,
                "Player_Choose": true,
                "GameStart": false
            },
            "ServerSetting": {
                "Region": "cn-shanghai",
                "ID": "server123",
                "Status": "running",
                "IP_Address": "192.168.1.100",
                "Port": "27015",
                "CreateTime": "2025-07-04 10:00:00"
            },
            "Status": "wait",
            "CreateTime": "2025-07-04 10:00:00"
        }
    ],
    "totalCount": 25,
    "currentPage": 1,
    "pageSize": 20,
    "totalPages": 2,
    "timestamp": "2025-07-04 10:30:00"
}
```

### RoomUpdated äº‹ä»¶

å½“å•ä¸ªæˆ¿é—´ä¿¡æ¯æœ‰æ›´æ–°æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå¹¿æ’­ `RoomUpdated` äº‹ä»¶ã€‚

#### äº‹ä»¶åç§°
`RoomUpdated`

#### äº‹ä»¶æ•°æ®
```json
{
    "ID": "072504001",
    "Name": "æµ‹è¯•æˆ¿é—´1",
    "Type": false,
    "OwnerID": "08233-87956-48746-16119-67337",
    "Members": [...],
    "Visitors": [],
    "ReadyPlayers": [],
    "GameSettings": {...},
    "RoomSetting": {...},
    "ServerSetting": {...},
    "Status": "wait",
    "CreateTime": "2025-07-04 10:00:00"
}
```

### RoomCreated äº‹ä»¶

å½“æœ‰æ–°æˆ¿é—´åˆ›å»ºæ—¶ï¼ŒæœåŠ¡å™¨ä¼šå¹¿æ’­ `RoomCreated` äº‹ä»¶ã€‚

#### äº‹ä»¶åç§°
`RoomCreated`

#### äº‹ä»¶æ•°æ®
```json
{
    "ID": "072504002",
    "Name": "æ–°æˆ¿é—´",
    "Type": false,
    "OwnerID": "12345-67890-12345-67890-12345",
    "Members": [...],
    "Visitors": [],
    "ReadyPlayers": [],
    "GameSettings": {...},
    "RoomSetting": {...},
    "ServerSetting": {...},
    "Status": "wait",
    "CreateTime": "2025-07-04 10:35:00"
}
```

### RoomDeleted äº‹ä»¶

å½“æˆ¿é—´è¢«åˆ é™¤æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå¹¿æ’­ `RoomDeleted` äº‹ä»¶ã€‚

#### äº‹ä»¶åç§°
`RoomDeleted`

#### äº‹ä»¶æ•°æ®
```json
"072504001"
```

## å®æ—¶æ›´æ–°æœºåˆ¶

### æ›´æ–°è§¦å‘æ¡ä»¶

1. **æˆ¿é—´è®¾ç½®å˜æ›´**ï¼šæˆ¿ä¸»ä¿®æ”¹æˆ¿é—´å¯†ç ã€æ¸¸æˆè®¾ç½®ç­‰
2. **ç©å®¶çŠ¶æ€å˜æ›´**ï¼šç©å®¶åŠ å…¥/ç¦»å¼€æˆ¿é—´
3. **æˆ¿é—´çŠ¶æ€å˜æ›´**ï¼šæˆ¿é—´å¼€å§‹æ¸¸æˆã€ç»“æŸæ¸¸æˆ
4. **æœåŠ¡å™¨çŠ¶æ€å˜æ›´**ï¼šæœåŠ¡å™¨åˆ›å»ºã€å¯åŠ¨ã€å…³é—­
5. **å®šæ—¶æ›´æ–°**ï¼šæ¯åˆ†é’Ÿè‡ªåŠ¨æ£€æŸ¥å¹¶å¹¿æ’­æ›´æ–°

**æ³¨æ„**ï¼šå®æ—¶æ›´æ–°æœºåˆ¶åªæ›´æ–°ç¬¬ä¸€é¡µçš„æˆ¿é—´åˆ—è¡¨ï¼Œå…¶ä»–é¡µé¢éœ€è¦ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°ã€‚

### æ›´æ–°æµç¨‹

<Mermaid
  chart="
    graph TD
    A[æˆ¿é—´å‘ç”Ÿå˜æ›´] --> B[è§¦å‘æ›´æ–°äº‹ä»¶]
    B --> C[æ£€æŸ¥è®¢é˜…è€…åˆ—è¡¨]
    C --> D[å¹¿æ’­RoomUpdatedäº‹ä»¶]
    D --> E[å‰ç«¯æ¥æ”¶æ›´æ–°]
    E --> F[æ›´æ–°UIæ˜¾ç¤º]
    G[å®šæ—¶æ£€æŸ¥] --> H[è·å–æœ€æ–°æˆ¿é—´åˆ—è¡¨]
    H --> I[å¹¿æ’­RoomListUpdatedäº‹ä»¶]
    I --> J[å‰ç«¯æ›´æ–°åˆ—è¡¨]
    "
/>

### æ€§èƒ½ä¼˜åŒ–

1. **åˆ†é¡µåŠ è½½**ï¼šåªè¿”å›å‰20æ¡æˆ¿é—´æ•°æ®
2. **å¢é‡æ›´æ–°**ï¼šä¼˜å…ˆä½¿ç”¨å•ä¸ªæˆ¿é—´æ›´æ–°äº‹ä»¶
3. **å®šæ—¶æ›´æ–°**ï¼šæ¯åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼Œé¿å…é¢‘ç¹æ›´æ–°
4. **è¿æ¥ç®¡ç†**ï¼šè‡ªåŠ¨æ¸…ç†æ–­å¼€çš„è¿æ¥
5. **å†…å­˜ç®¡ç†**ï¼šåŠæ—¶æ¸…ç†æ— æ•ˆçš„è®¢é˜…è€…

## é”™è¯¯å¤„ç†

### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | å¤„ç†æ–¹å¼ |
|--------|----------|----------|
| 1001 | å‚æ•°é”™è¯¯ | æ£€æŸ¥é¡µç æ˜¯å¦å¤§äºç­‰äº1 |
| 1002 | é¡µç è¶…å‡ºèŒƒå›´ | æ£€æŸ¥é¡µç æ˜¯å¦è¶…è¿‡æ€»é¡µæ•° |
| 1003 | è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥ | æ£€æŸ¥æ•°æ®åº“è¿æ¥ |
| 1004 | è®¢é˜…æ›´æ–°å¤±è´¥ | æ£€æŸ¥ç½‘ç»œè¿æ¥ |

### å‰ç«¯é”™è¯¯å¤„ç†ç¤ºä¾‹

```javascript
    // é”™è¯¯å¤„ç†
    const getRoomList = async (page = 1) => {
        try {
            const result = await invoke("GetMatchesRoomList", page);
            setRoomList(result.rooms);
            setTotalCount(result.totalCount);
        } catch (error) {
            console.error("è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥:", error);
            showErrorMessage("è·å–æˆ¿é—´åˆ—è¡¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•");
        }
    };

// ç½‘ç»œæ–­å¼€é‡è¿å¤„ç†
useEffect(() => {
    if (!isConnected) {
        console.log("ç½‘ç»œè¿æ¥æ–­å¼€ï¼Œå°è¯•é‡è¿...");
        // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é‡è¿é€»è¾‘
    }
}, [isConnected]);
```

## æ‰§è¡Œæµç¨‹å›¾

<Mermaid
  chart="
graph TD
    A[å‰ç«¯è°ƒç”¨GetMatchesRoomList] --> B[éªŒè¯é¡µç å‚æ•°]
    B --> C{é¡µç æ˜¯å¦æœ‰æ•ˆ?}
    C -->|å¦| D[è¿”å›é”™è¯¯]
    C -->|æ˜¯| E[è·å–å…¬å¼€æˆ¿é—´åˆ—è¡¨]
    E --> F[è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼]
    F --> G[æ·»åŠ ç”¨æˆ·åˆ°è®¢é˜…è€…åˆ—è¡¨]
    G --> H[åŠ å…¥å¤§å…å¹¿æ’­ç»„]
    H --> I[è¿”å›æˆ¿é—´åˆ—è¡¨å’Œæ€»æ•°]
    
    J[æˆ¿é—´å‘ç”Ÿå˜æ›´] --> K[è§¦å‘æ›´æ–°äº‹ä»¶]
    K --> L[å¹¿æ’­RoomUpdatedäº‹ä»¶]
    L --> M[å‰ç«¯æ¥æ”¶å¹¶æ›´æ–°UI]
    
    N[å®šæ—¶æ£€æŸ¥] --> O[è·å–æœ€æ–°æˆ¿é—´åˆ—è¡¨]
    O --> P[å¹¿æ’­RoomListUpdatedäº‹ä»¶]
    P --> Q[å‰ç«¯æ›´æ–°åˆ—è¡¨æ˜¾ç¤º]
    
    D --> R[é”™è¯¯å¤„ç†]
    R --> S[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]"
/>
